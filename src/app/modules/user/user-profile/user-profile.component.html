<div class="user-profile-container">
	<div class="user-profile-left">
		<div style="text-align: center;">
			<div *ngIf="user?.roleId === 1" class="admin-badge">
				<img alt="key" src="../../../../assets/images/icons/key_white.png">
			</div>
			<img alt="avatar" src="../../../../assets/images/avatar.png">
		</div>
		<div class="user-profile-left-photo-upload">
			UPLOAD A PHOTO
		</div>
		<div class="user-profile-left-user-name">
			<div>
				{{user?.firstName}}
			</div>
			<div>
				{{user?.lastName}}
			</div>
		</div>
		<div class="user-profile-left-email">
			{{user?.email}}
		</div>
		<div style="text-align: center;">
			<button class="resend-invite-button">
				Resend the invite
			</button>
		</div>
	</div>
	<div class="user-profile-center">
		<div class="user-profile-center-title">
			Details
		</div>
		<div class="user-profile-center-status">
			<div>
				<app-toggle [isActive]="user?.isActive" (onChange)="onUserStatusChange($event)"></app-toggle>
			</div>
			<div>
				The user is <span>
				{{user?.isActive ? 'Active' : 'Inactive'}}
			</span>
			</div>
		</div>
		<form [formGroup]="userForm">
			<div class="form">
				<div class="form-row">
					<label>
						<input type="text"
							   placeholder="* First Name"
							   formControlName="firstName">
					</label>
				</div>
				<div class="form-row">
					<label>
						<input type="text"
							   placeholder="* Last Name"
							   formControlName="lastName">
					</label>
				</div>
				<div class="form-row">
					<label>
						<select formControlName="roleId">
							<option *ngFor="let role of userService.getRoles()" [value]="role.id">
								{{role.name}}
							</option>
						</select>
					</label>
				</div>
				<div class="user-form-control">
					<button (click)="onSaveUserChangesClick()"
							class="save-changes-button"
							[disabled]="!userForm.valid">
						Save Changes
					</button>
				</div>
			</div>
		</form>
	</div>
	<div class="user-profile-right">
		<div class="user-profile-right-permissions">
			<div class="user-profile-right-permissions-title">
				Permissions
			</div>
			<div class="user-profile-right-permissions-role">
				{{user?.roleId ? userService.getRoleNameById(+userForm.get('roleId').value) : ''}}
			</div>
		</div>

		<div *ngFor="let permission of userService.getPermissionsWithoutGroup()"
			 class="user-profile-right-permission-list">
			<div class="user-profile-right-permissions-list-title">
				{{permission.name}}
			</div>
			<div>
				<app-toggle
					[isActive]="userService.getUserPermissionStatus(user, +userForm.get('roleId').value, permission.id)"
					(onChange)="onPermissionStatusChange(permission.id, $event)"></app-toggle>
			</div>
		</div>

		<div *ngFor="let permissionGroup of userService.getPermissionGroups(); index as i;">
			<div style="display: flex; flex-direction: row; justify-content: space-between;">
				<div (click)="content.style.display = content.style.display === 'none' ? 'block' : 'none'">
					<b>
						{{permissionGroup.name}}
					</b>
				</div>
				<div>
					<app-toggle
						[isActive]="userService.getUserPermissionGroupStatus(user, +userForm.get('roleId').value, permissionGroup.id)"
						(onChange)="onPermissionGroupStatusChange(permissionGroup.id, $event)"></app-toggle>
				</div>
			</div>
			<div #content [ngStyle]="{'display': i == 0 ? 'block' : 'none'}">
				<div *ngFor="let permission of userService.getPermissions(permissionGroup.id)">
					<div style="display: flex; flex-direction: row; justify-content: space-between;">
						<div>
							{{permission.name}}
						</div>
						<div>
							<app-toggle
								[isActive]="userService.getUserPermissionStatus(user, +userForm.get('roleId').value, permission.id)"
								(onChange)="onPermissionStatusChange(permission.id, $event)"></app-toggle>
						</div>
					</div>
				</div>
			</div>
		</div>

	</div>
</div>
